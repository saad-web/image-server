local sig, size, path, ext =
  ngx.var.sig, ngx.var.size, ngx.var.path, ngx.var.ext

local images_dir = "/data/images/"
local source_fname = images_dir .. path
local function return_not_found(msg)
  ngx.status = ngx.HTTP_NOT_FOUND
  ngx.header["Content-type"] = "text/html"
  ngx.say(msg or "not found")
  ngx.exit(0)
end


local f = io.open(source_fname, "rb")
if not f then
  return_not_found("file not found"..source_fname)
end
local content = f:read("*all")
f:close()
ngx.print(content)
